<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts\libraries\LEvents.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">all files</a> / <a href="index.html">contracts/libraries/</a> LEvents.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>50/50</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>22/22</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>24/24</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>59/59</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">176×</span>
<span class="cline-any cline-yes">172×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-yes">17×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">188×</span>
<span class="cline-any cline-yes">171×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">153×</span>
<span class="cline-any cline-yes">149×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">176×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">176×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">163×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">17×</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">16×</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">149×</span>
<span class="cline-any cline-yes">148×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">103×</span>
<span class="cline-any cline-yes">76×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-yes">13×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">107×</span>
<span class="cline-any cline-yes">100×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">17×</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">20×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">189×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">172×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">176×</span>
<span class="cline-any cline-yes">176×</span>
<span class="cline-any cline-yes">176×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">388×</span>
<span class="cline-any cline-yes">388×</span>
<span class="cline-any cline-yes">388×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">373×</span>
<span class="cline-any cline-yes">373×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">213×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">39×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">pragma solidity ^0.4.24;
&nbsp;
import '../interfaces/IAventusStorage.sol';
import './LAventities.sol';
import "./LAventusTime.sol";
import "./LEventsCommon.sol";
import "./LEventsEnact.sol";
import "./LEventsTickets.sol";
import "./LMerkleRoots.sol";
import './LProposal.sol';
import "./LEventsStorage.sol";
&nbsp;
/* @dev All external methods in here are called from EventsManager and have the same function signature (and interface
 * documentation) as their namesakes in EventsManager. Each of these methods should do the following and ONLY the following:
 *   - check that the event is in the correct state
 *   - call the method of the same name in a sublibrary to actually make the required change
 *   - emit the correct log
 * In particular, the methods SHOULD NOT check proofs or msg.sender validity - these checks should be done in the sublibrary.
 */
&nbsp;
library LEvents {
&nbsp;
  enum EventState {NonExistent, Reporting, Trading, Inactive}
&nbsp;
  // See IEventsManager interface for logs description
  event LogEventCreated(uint indexed eventId, string eventDesc, string eventSupportURL, uint onSaleTime, uint offSaleTime,
      uint averageTicketPriceInUSCents, uint depositInAVTDecimals);
  event LogEventCancelled(uint indexed eventId);
  event LogEventEnded(uint indexed eventId);
  event LogTicketSale(uint indexed eventId, uint indexed ticketId, bytes32 vendorTicketRefHash, string ticketMetadata,
      bytes vendorProof, bytes doorData, address indexed buyer);
  event LogTicketReturn(uint indexed eventId, uint indexed ticketId, bytes vendorProof);
  event LogTicketResale(uint indexed eventId, uint indexed ticketId, address indexed newBuyer, bytes resellerProof);
  event LogTicketListed(uint indexed eventId, uint ticketId, address indexed ticketOwner, bytes32 indexed leafHash);
  event LogTicketSentToFriend(uint indexed eventId, uint indexed ticketId, bytes newDoorData);
  event LogMemberRegisteredOnEvent(uint indexed eventId, address indexed memberAddress, string memberType);
  event LogMemberDeregisteredFromEvent(uint indexed eventId, address indexed memberAddress, string memberType);
  event LogEventChallenged(uint indexed eventId, uint indexed proposalId, uint lobbyingStart, uint votingStart,
      uint revealingStart, uint revealingEnd);
  event LogEventChallengeEnded(uint indexed eventId, uint indexed proposalId, uint votesFor, uint votesAgainst);
&nbsp;
  modifier onlyWhenHashNonExistent(IAventusStorage _storage, bytes32 _eventHash) {
    require(!LEventsStorage.isExistingEventHash(_storage, _eventHash), "Event already exists");
    _;
  }
&nbsp;
  modifier onlyWhenActive(IAventusStorage _storage, uint _eventId) {
    EventState state = getEventState(_storage, _eventId);
    require(EventState.Trading == state || EventState.Reporting == state, "Event must be active");
    _;
  }
&nbsp;
  modifier onlyWhenTrading(IAventusStorage _storage, uint _eventId) {
    require(EventState.Trading == getEventState(_storage, _eventId), "Event must be trading");
    _;
  }
&nbsp;
  modifier onlyInReportingPeriod(IAventusStorage _storage, uint _eventId) {
    require(EventState.Reporting == getEventState(_storage, _eventId), "Event must be in reporting period");
    _;
  }
&nbsp;
  modifier onlyWhenInactive(IAventusStorage _storage, uint _eventId) {
    require(EventState.Inactive == getEventState(_storage, _eventId), "Event must be inactive");
    _;
  }
&nbsp;
  function createEvent(IAventusStorage _storage, string _eventDesc, string _eventSupportURL, uint _onSaleTime,
      uint _offSaleTime, uint _averageTicketPriceInUSCents, bytes _ownerProof)
    external
  {
    bytes32 eventHash = getEventHash(_eventDesc, _eventSupportURL, _onSaleTime, _offSaleTime,
        _averageTicketPriceInUSCents);
    (uint eventId, uint depositInAVTDecimals) = doCreateEvent(_storage, _eventSupportURL, _onSaleTime, _offSaleTime,
        _averageTicketPriceInUSCents, _ownerProof, eventHash);
    emit LogEventCreated(eventId, _eventDesc, _eventSupportURL, _onSaleTime, _offSaleTime, _averageTicketPriceInUSCents,
        depositInAVTDecimals);
  }
&nbsp;
  function challengeEvent(IAventusStorage _storage, uint _eventId)
    external
    onlyWhenActive(_storage, _eventId)
  {
    uint proposalId = LEventsEnact.challengeEvent(_storage, _eventId);
    (uint lobbyingStart, uint votingStart, uint revealingStart, uint revealingEnd) = LProposal.getTimestamps(_storage,
        proposalId);
    emit LogEventChallenged(_eventId, proposalId, lobbyingStart, votingStart, revealingStart, revealingEnd);
  }
&nbsp;
  function endEventChallenge(IAventusStorage _storage, uint _eventId)
    external
  {
    (uint proposalId, uint votesFor, uint votesAgainst) = LEventsEnact.endEventChallenge(_storage, _eventId);
    emit LogEventChallengeEnded(_eventId, proposalId, votesFor, votesAgainst);
  }
&nbsp;
  function cancelEvent(IAventusStorage _storage, uint _eventId, bytes _ownerProof)
    external
    onlyInReportingPeriod(_storage, _eventId)
  {
    LEventsEnact.cancelEvent(_storage, _eventId, _ownerProof);
    emit LogEventCancelled(_eventId);
  }
&nbsp;
  function endEvent(IAventusStorage _storage, uint _eventId)
    external
    onlyWhenInactive(_storage, _eventId)
  {
    LEventsEnact.endEvent(_storage, _eventId);
    emit LogEventEnded(_eventId);
  }
&nbsp;
  function sellTicket(IAventusStorage _storage, uint _eventId, bytes32 _vendorTicketRefHash,
      string _ticketMetadata, address _buyer, bytes _vendorProof, bytes _doorData)
    external
    onlyWhenTrading(_storage, _eventId)
  {
    uint ticketId = LEventsTickets.addTicket(_storage, _eventId, _vendorTicketRefHash, _buyer, _vendorProof, _doorData);
    emit LogTicketSale(_eventId, ticketId, _vendorTicketRefHash, _ticketMetadata, _vendorProof, _doorData, _buyer);
  }
&nbsp;
  function returnTicket(IAventusStorage _storage, uint _eventId, uint _ticketId, bytes _vendorProof)
    external
    onlyWhenTrading(_storage, _eventId)
  {
    LEventsTickets.returnTicket(_storage, _eventId, _ticketId, _vendorProof);
    emit LogTicketReturn(_eventId, _ticketId, _vendorProof);
  }
&nbsp;
  function resellTicket(IAventusStorage _storage, uint _eventId, uint _ticketId, bytes _ticketOwnerPermission,
      address _newBuyer, bytes _resellerProof, bytes _doorData)
    external
    onlyWhenTrading(_storage, _eventId)
  {
    LEventsTickets.resellTicket(_storage, _eventId, _ticketId, _ticketOwnerPermission, _newBuyer, _resellerProof, _doorData);
    emit LogTicketResale(_eventId, _ticketId, _newBuyer, _resellerProof);
  }
&nbsp;
  function sendTicketToFriend(IAventusStorage _storage, uint _eventId, uint _ticketId, bytes _ticketOwnerPermission,
      bytes _newDoorData)
    external
    onlyWhenTrading(_storage, _eventId)
  {
    LEventsTickets.sendTicketToFriend(_storage, _eventId, _ticketId, _ticketOwnerPermission, _newDoorData);
    emit LogTicketSentToFriend(_eventId, _ticketId, _newDoorData);
  }
&nbsp;
  function listTicketA(IAventusStorage _storage, uint _eventId, bytes32 _vendorTicketRefHash, string _ticketMetadata,
      bytes _vendorProof, bytes _doorData, bytes _ticketOwnerProof)
    external
  {
    address ticketOwner = LEventsCommon.getSignerFromProof(_vendorTicketRefHash, _ticketOwnerProof);
    bytes32 leafHash = keccak256(abi.encodePacked(_eventId, _vendorTicketRefHash, _ticketMetadata, ticketOwner, _vendorProof,
        _doorData));
    _storage.setBytes32(keccak256(abi.encodePacked("Event", _eventId, "vendorTicketRefHash", _vendorTicketRefHash, "leafHash")),
        leafHash);
    _storage.setAddress(keccak256(abi.encodePacked("LeafHash", leafHash, "ticketOwner")), ticketOwner);
  }
&nbsp;
  function listTicketB(IAventusStorage _storage, uint _eventId, bytes32 _vendorTicketRefHash, bytes32[] _merklePath)
    view
    external
    onlyWhenTrading(_storage, _eventId)
  {
    bytes32 leafHash = _storage.getBytes32(keccak256(abi.encodePacked("Event", _eventId, "vendorTicketRefHash",
        _vendorTicketRefHash, "leafHash")));
    bytes32 rootHash = LMerkleRoots.generateMerkleRoot(_storage, _merklePath, leafHash);
    require(LMerkleRoots.merkleRootIsActive(_storage, rootHash), "Merkle root is not active");
  }
&nbsp;
  function listTicketC(IAventusStorage _storage, uint _eventId, bytes32 _vendorTicketRefHash, bytes _vendorProof,
      bytes _doorData)
    external
  {
    bytes32 leafHash =_storage.getBytes32(keccak256(abi.encodePacked("Event", _eventId, "vendorTicketRefHash",
        _vendorTicketRefHash, "leafHash")));
    address ticketOwner = _storage.getAddress(keccak256(abi.encodePacked("LeafHash", leafHash, "ticketOwner")));
    uint ticketId = LEventsTickets.addTicket(_storage, _eventId, _vendorTicketRefHash, ticketOwner, _vendorProof, _doorData);
    emit LogTicketListed(_eventId, ticketId, ticketOwner, leafHash);
  }
&nbsp;
  function registerMemberOnEvent(IAventusStorage _storage, uint _eventId, address _memberAddress, string _memberType)
    external
  {
    if (LEventsCommon.registerMemberOnEvent(_storage, _eventId, _memberAddress, _memberType)) {
      emit LogMemberRegisteredOnEvent(_eventId, _memberAddress, _memberType);
    }
  }
&nbsp;
  function deregisterMemberFromEvent(IAventusStorage _storage, uint _eventId, address _memberAddress, string _memberType)
    external
  {
    if (LEventsCommon.deregisterMemberFromEvent(_storage, _eventId, _memberAddress, _memberType)) {
      emit LogMemberDeregisteredFromEvent(_eventId, _memberAddress, _memberType);
    }
  }
&nbsp;
  function getExistingEventDeposit(IAventusStorage _storage, uint _eventId) external view returns (uint eventDeposit_) {
    eventDeposit_ = LEventsCommon.getExistingEventDeposit(_storage, _eventId);
  }
&nbsp;
  function getNewEventDeposit(IAventusStorage _storage, uint _averageTicketPriceInUSCents)
    external
    view
    returns (uint depositInUSCents_, uint depositInAVTDecimals_)
  {
    (depositInUSCents_, depositInAVTDecimals_) = LEventsCommon.getNewEventDeposit(_storage, _averageTicketPriceInUSCents);
  }
&nbsp;
  function doCreateEvent(IAventusStorage _storage, string _eventSupportURL, uint _onSaleTime,
      uint _offSaleTime, uint _averageTicketPriceInUSCents, bytes _ownerProof, bytes32 _eventHash)
    private
    onlyWhenHashNonExistent(_storage, _eventHash)
    returns (uint eventId_, uint depositInAVTDecimals_)
  {
    (eventId_,  depositInAVTDecimals_) = LEventsEnact.createEvent(_storage, _eventSupportURL, _onSaleTime,
        _offSaleTime, _averageTicketPriceInUSCents, _ownerProof, _eventHash);
  }
&nbsp;
  function getEventHash(string _eventDesc, string _eventSupportURL, uint _onSaleTime, uint _offSaleTime,
      uint _averageTicketPriceInUSCents)
    private
    pure
    returns (bytes32 eventHash_)
  {
    // Hash the variable length parameters to create fixed length parameters.
    // See: http://solidity.readthedocs.io/en/v0.4.21/abi-spec.html#abi-packed-mode
    bytes32 descHash = keccak256(abi.encodePacked(_eventDesc));
    bytes32 supportURLHash = keccak256(abi.encodePacked(_eventSupportURL));
    eventHash_ = keccak256(abi.encodePacked(descHash, supportURLHash, _onSaleTime, _offSaleTime, _averageTicketPriceInUSCents));
  }
&nbsp;
  function getEventState(IAventusStorage _storage, uint _eventId) private view returns (EventState) {
    uint eventAventityId = LEventsStorage.getAventityId(_storage, _eventId);
    bool eventAventityIsActive = LAventities.aventityIsActive(_storage, eventAventityId);
    if (!eventAventityIsActive) return EventState.NonExistent;
&nbsp;
    uint currentTime = LAventusTime.getCurrentTime(_storage);
    if (currentTime &gt;= LEventsStorage.getOffSaleTime(_storage, _eventId)) return EventState.Inactive;
&nbsp;
    if (currentTime &gt;= LEventsStorage.getOnSaleTime(_storage, _eventId)) return EventState.Trading;
&nbsp;
    return EventState.Reporting;
  }
}</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Thu Oct 18 2018 13:27:15 GMT+0100 (GMT Daylight Time)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
